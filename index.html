
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beauty Products Professional AI NLP</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --main: #d63384; --dark: #1a1d20; --bg: #f8f9fa; --white: #ffffff; }
        body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); margin: 0; color: #333; }
        .navbar { background: var(--dark); color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
        .container { max-width: 1200px; margin: 20px auto; padding: 0 15px; }
        
        .dashboard-grid { display: grid; grid-template-columns: 420px 1fr; gap: 20px; }
        @media (max-width: 950px) { .dashboard-grid { grid-template-columns: 1fr; } }
        
        .card { background: var(--white); border-radius: 12px; padding: 25px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; }
        textarea { width: 100%; height: 160px; border: 1px solid #ddd; border-radius: 8px; padding: 12px; font-size: 14px; resize: none; box-sizing: border-box; outline-color: var(--main); line-height: 1.5; }
        
        .btn { padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.2s; width: 100%; margin-top: 10px; }
        .btn-main { background: var(--main); color: white; font-size: 16px; }
        .btn-excel { background: #1f7244; color: white; width: auto; padding: 10px 20px; }
        .btn-copy { background: #636e72; color: white; width: auto; padding: 5px 12px; font-size: 11px; margin-top: 8px; float: right; }
        .btn-copy:hover { background: var(--main); }
        
        .search-box { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 15px; font-size: 14px; padding-left: 35px; background: #fff url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="gray"><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/></svg>') no-repeat 10px center; }
        .item { border-bottom: 1px solid #eee; padding: 20px 0; overflow: hidden; }
        .badge { padding: 4px 10px; border-radius: 4px; font-size: 10px; font-weight: bold; text-transform: uppercase; margin-right: 5px; display: inline-block; }
        .tag-skin { background: #ffeaa7; color: #d35400; }
        .tag-rider { background: #fab1a0; color: #e17055; }
        .tag-neg { background: #ff7675; color: white; }
        .tag-pos { background: #55efc4; color: #006266; }
        
        .response-card { background: #fdf2f7; border-left: 5px solid var(--main); padding: 15px; margin-top: 15px; font-size: 13.5px; border-radius: 4px; line-height: 1.6; clear: both; }
        .strategy-box { background: #f1f3f5; border-radius: 6px; padding: 12px; margin-top: 10px; font-size: 12.5px; color: #2d3436; border-left: 5px solid #636e72; }
    </style>
</head>
<body>

    <nav class="navbar">
        <div style="font-weight: 800; letter-spacing: 1px; font-size: 20px;">ðŸŒ¸ BEAUTY PRO AI NLP</div>
        <button class="btn btn-excel" onclick="exportToExcel()">ðŸ“¥ Export Report (.xlsx)</button>
    </nav>

    <div class="container">
        <div class="dashboard-grid">
            <div>
                <div class="card">
                    <h3 style="margin-top:0">Review Intake</h3>
                    <p style="font-size: 12px; color: #666;">Jeje-ready analyzer (e.g., '22o', 'q', 'uminit')</p>
                    <textarea id="reviewInput" placeholder="Paste customer review here..."></textarea>
                    <button class="btn btn-main" onclick="analyze()">Deep Scan Analysis</button>
                    <button onclick="clearHistory()" style="background:none; border:none; color:#bbb; font-size:11px; margin-top:15px; cursor:pointer; width:100%;">Reset Analyzer Data</button>
                </div>
                <div class="card">
                    <h3 style="margin-top:0">Market Sentiment</h3>
                    <canvas id="chartArea"></canvas>
                </div>
            </div>

            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h3 style="margin:0">Analysis History</h3>
                    <input type="text" id="search" class="search-box" style="width:250px; margin:0;" placeholder="Search keyword..." onkeyup="render()">
                </div>
                <div id="historyList"></div>
            </div>
        </div>
    </div>

<script>
    let db = JSON.parse(localStorage.getItem('beauty_pro_final_v4')) || [];

    const jejeMap = { "22o": "totoo", "q": "ko", "aq": "ako", "muka": "mukha", "wla": "wala", "d": "hindi", "u": "ikaw", "uminit": "mainit", "2nd": "pangalawang" };

    const dict = {
        skin: /tigyawat|bumps|butlig|hapdi|kirot|mainit|u?minit|kati|namumula|nasunog|pimple|breakout|sumabog|lumala/i,
        efficacy: /hiyang|kinis|glow|pumuti|tuyo|effective|smooth/i,
        rider: /rider|delivery|mabilis|matagal|attitude|bastos|mura|ugali|suplado|snob|kuya|nagtext|tumawag/i,
        negation: /hindi|di\s+naman|fake|peke|sayang|wa\s+epek|budol|mahal|walang/i
    };

    function analyze() {
        const rawText = document.getElementById('reviewInput').value.trim();
        if(!rawText) return;

        let processedText = rawText.toLowerCase();
        Object.keys(jejeMap).forEach(key => {
            processedText = processedText.replace(new RegExp(`\\b${key}\\b`, 'g'), jejeMap[key]);
        });

        let risk = 1;
        let issues = [];
        let sentiment = "Neutral";

        if(dict.skin.test(processedText)) { risk += 5; issues.push("Skin Reaction"); }
        if(dict.rider.test(rawText)) { risk += 3; issues.push("Rider Behavior"); }
        if(dict.negation.test(processedText)) { risk += 2; }

        if(risk > 3 || dict.negation.test(processedText)) sentiment = "Negative";
        else if(dict.efficacy.test(processedText)) sentiment = "Positive";

        let response = "";
        let strategy = "";

        if(issues.includes("Skin Reaction")) {
            response = "Thank you for bringing this to our attention immediately. Your safety is our absolute priority. Please discontinue use of the product right away. Maaari po kayong mag-apply ng cold compress at uminom ng maraming tubig. We will contact you via DM to monitor your skin's condition.";
            strategy = "Product Safety Action: Offer a refund or consultation. Check batch chemical concentration.";
        } else if(issues.includes("Rider Behavior")) {
            response = "Pasensya na po sa naging karanasan ninyo kay Rider. Hindi po namin kinukunsinti ang ganyang behavior. I-re-report po namin ito sa aming courier partner branch para mabigyan ng kaukulang aksyon at hindi na maulit.";
            strategy = "Logistics Strategy: Formally report rider/courier branch. Follow up on parcel handling.";
        } else if(sentiment === "Positive") {
            response = "Thank you for your trust on our brand, we hope we are able to satisfy you till the end! âœ¨ We are so happy na naging hiyang kayo. Stay glowing!";
            strategy = "Marketing Strategy: High satisfaction. Encourage them to join the loyalty program.";
        } else {
            response = "Maraming salamat po sa inyong honest feedback. Gagamitin po namin ito upang lalong mapaganda ang aming produkto at serbisyo para sa inyo.";
            strategy = "Standard Support: Monitor for recurring minor suggestions.";
        }

        db.push({ id: Date.now(), original: rawText, sentiment, issues, response, strategy, date: new Date().toLocaleString() });
        localStorage.setItem('beauty_pro_final_v4', JSON.stringify(db));
        document.getElementById('reviewInput').value = "";
        updateDashboard();
    }

    function render() {
        const search = document.getElementById('search').value.toLowerCase();
        const list = document.getElementById('historyList');
        const filtered = db.filter(i => i.original.toLowerCase().includes(search) || i.issues.join().toLowerCase().includes(search));
        
        list.innerHTML = filtered.length ? filtered.reverse().map(i => `
            <div class="item">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div>
                        <span class="badge ${i.sentiment === 'Positive' ? 'tag-pos' : 'tag-neg'}">${i.sentiment}</span>
                        ${i.issues.map(tag => `<span class="badge ${tag.includes('Skin')?'tag-skin':'tag-rider'}">${tag}</span>`).join('')}
                    </div>
                    <small style="color:#999;">${i.date}</small>
                </div>
                <p style="margin:12px 0; font-size:14.5px; line-height:1.5; color:#2d3436; font-style:italic;">"${i.original}"</p>
                <button class="btn-copy" onclick="copyResponse('${i.id}')">ðŸ“‹ Copy Response</button>
                <div class="response-card" id="resp-${i.id}">
                    <b style="color:var(--main); font-size:11px; text-transform:uppercase; letter-spacing:1px;">âœ¨ Suggested Response</b><br>${i.response}
                </div>
                <div class="strategy-box">
                    <b>ðŸ’¡ Best Thing to Do:</b> ${i.strategy}
                </div>
            </div>
        `).join('') : '<p style="text-align:center; color:#999; margin-top:50px;">No records found.</p>';
    }

    function copyResponse(id) {
        const item = db.find(x => x.id == id);
        if (item) {
            navigator.clipboard.writeText(item.response).then(() => {
                const btn = event.target;
                const originalText = btn.innerText;
                btn.innerText = "âœ… Copied!";
                btn.style.backgroundColor = "#2ecc71";
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.style.backgroundColor = "#636e72";
                }, 2000);
            });
        }
    }

    function updateDashboard() {
        render();
        const pos = db.filter(i => i.sentiment === "Positive").length;
        const neg = db.filter(i => i.sentiment === "Negative").length;
        const neu = db.length - (pos + neg);
        updateChart(pos, neg, neu);
    }

    function exportToExcel() {
        if(!db.length) return alert("Nothing to export.");
        const ws = XLSX.utils.json_to_sheet(db);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "AnalysisHistory");
        XLSX.writeFile(wb, "Beauty_Pro_NLP_Report.xlsx");
    }

    let myChart;
    function updateChart(p, n, u) {
        const ctx = document.getElementById('chartArea').getContext('2d');
        if(myChart) myChart.destroy();
        myChart = new Chart(ctx, {
            type: 'doughnut',
            data: { 
                labels: ['Happy', 'Issues', 'Neutral'], 
                datasets: [{ data:[p, n, u], backgroundColor: ['#2ecc71', '#ff7675', '#dfe6e9'], borderWidth: 0 }] 
            },
            options: { cutout: '70%', plugins: { legend: { position: 'bottom' } } }
        });
    }

    function clearHistory() {
        if(confirm("Confirm reset? This deletes all records.")) {
            localStorage.removeItem('beauty_pro_final_v4');
            db = [];
            location.reload();
        }
    }
    
    updateDashboard();
</script>
</body>
</html>
